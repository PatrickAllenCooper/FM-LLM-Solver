FROM python:3.13-slim

RUN groupadd -r fmllm && useradd -r -g fmllm fmllm
WORKDIR /app

# Install only Flask
RUN pip3 install flask

# Copy simple app
COPY simple_web_app.py ./

# Create writable logs directory
RUN mkdir -p /app/logs && chown -R fmllm:fmllm /app

USER fmllm

HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:5000/health || exit 1

EXPOSE 5000

CMD ["python3", "simple_web_app.py"]
